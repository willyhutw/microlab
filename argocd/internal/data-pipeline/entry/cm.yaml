apiVersion: v1
kind: ConfigMap
metadata:
  name: data-entry
  namespace: monitoring
data:
  fluent-bit.yaml: |-
    service:
      log_level: info
    pipeline:
      inputs:
        - name: syslog
          parser: syslog-rfc5424
          port: 5140
          mode: udp
      outputs:
        - name: forward
          match: '*'
          host: data-filter-pfsense-flb
          port: 24226
    parsers:
      - name: syslog-rfc5424
        format: regex
        regex: ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)) (?<message>.+)$
        time_key: time
        time_format: '%Y-%m-%dT%H:%M:%S.%L%z'
        time_keep: true
