apiVersion: v1
kind: ConfigMap
metadata:
  name: data-entry
  namespace: monitoring
data:
  fluent-bit.yaml: |-
    service:
      log_level: info
      parsers_file: parsers.conf
    pipeline:
      inputs:
        - name: syslog
          parser: syslog-rfc5424
          port: 5140
          mode: udp
      outputs:
        - name: forward
          match: '*'
          host: data-filter-pfsense
          port: 24225
  parsers.conf: |-
    [PARSER]
        Name        syslog-rfc5424
        Format      regex
        Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)) (?<message>.+)$
        Time_Key    time
        Time_Format %Y-%m-%dT%H:%M:%S.%L%z
        Time_Keep   On
